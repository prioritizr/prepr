<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>prepr: Automatic Repair of Spatial Polygons</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">prepr: Automatic Repair of Spatial
Polygons</h1>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#tutorial" id="toc-tutorial">Tutorial</a>
<ul>
<li><a href="#a-bowtie-polygon" id="toc-a-bowtie-polygon">A ‘bowtie’
polygon</a></li>
<li><a href="#square-with-wrong-orientation" id="toc-square-with-wrong-orientation">Square with wrong
orientation</a></li>
<li><a href="#inner-ring-with-one-edge-sharing-part-of-an-edge-of-the-outer-ring" id="toc-inner-ring-with-one-edge-sharing-part-of-an-edge-of-the-outer-ring">Inner
ring with one edge sharing part of an edge of the outer ring</a></li>
<li><a href="#dangling-edge" id="toc-dangling-edge">Dangling
edge</a></li>
<li><a href="#two-adjacent-inner-rings" id="toc-two-adjacent-inner-rings">Two adjacent inner rings</a></li>
<li><a href="#polygon-with-an-inner-ring-inside-another-inner-ring" id="toc-polygon-with-an-inner-ring-inside-another-inner-ring">Polygon
with an inner ring inside another inner ring</a></li>
</ul></li>
<li><a href="#citation" id="toc-citation">Citation</a></li>
<li><a href="#getting-help" id="toc-getting-help">Getting help</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <em>prepr R</em> R package is used to repair broken spatial
polygons. To achieve this, the package uses the constrained
triangulation approach implemented in the <a href="https://github.com/tudelft3d/prepair"><code>prepair</code></a> C++
library (<a href="https://doi.org/10.1016/j.cageo.2014.01.009">Ledoux et
al. 2014</a>). Specifically, the main <code>st_prepair()</code> function
is used to repair polygons.</p>
</div>
<div id="tutorial" class="section level2">
<h2>Tutorial</h2>
<p>Here we provide a short tutorial showing how the <em>prepr</em>
package can be used to repair broken polygon geometries. To start with,
we will load the package. We will also load the <em>sf</em> package for
working with spatial data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(sf)    <span class="co"># package for working with spatial data</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(prepr) <span class="co"># package for repairing spatial geometries</span></span></code></pre></div>
<p>We will now show how the <em>prepr</em> package can be used to repair
broken geometries. To achieve this, we will examine a range of different
mechanisms by which polygons can be broken. For each of these
mechanisms, we will manually create a broken polygon geometry based on
the mechanism, repair the geometry (using <code>st_prepair()</code>),
and then compare the repaired geometry with the original broken
geometry. We will also confirm that the broken geometries have indeed
been repaired (using <code>sf::st_is_valid()</code>).</p>
<div id="a-bowtie-polygon" class="section level3">
<h3>A ‘bowtie’ polygon</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># create broken polygon</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">st_as_sfc</span>(<span class="st">&quot;POLYGON((0 0, 0 10, 10 0, 10 10, 0 0))&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># verify that polygon is broken, and display reason why it&#39;s broken</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">st_is_valid</span>(x, <span class="at">reason =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Self-intersection[5 5]&quot;</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># repair the polygon</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">st_prepair</span>(x)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># verify that repaired polygon is NOT broken</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">st_is_valid</span>(y)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># visualize the polygons</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">0</span>))</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main =</span> <span class="st">&quot;original&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(x, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">main =</span> <span class="st">&quot;repaired&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(y, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="square-with-wrong-orientation" class="section level3">
<h3>Square with wrong orientation</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># create broken polygon</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">st_as_sfc</span>(<span class="st">&quot;POLYGON((0 0, 0 10, 10 10, 10 0, 0 0))&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># verify that polygon is broken, and display reason why it&#39;s broken</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">st_is_valid</span>(x, <span class="at">reason =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Valid Geometry&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># repair the polygon</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">st_prepair</span>(x)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># verify that repaired polygon is NOT broken</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">st_is_valid</span>(y)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># visualize the polygons</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">0</span>))</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main =</span> <span class="st">&quot;original&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(x, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">main =</span> <span class="st">&quot;repaired&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(y, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="inner-ring-with-one-edge-sharing-part-of-an-edge-of-the-outer-ring" class="section level3">
<h3>Inner ring with one edge sharing part of an edge of the outer
ring</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># create broken polygon</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">st_as_sfc</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="st">&quot;POLYGON((0 0, 10 0, 10 10, 0 10, 0 0),(5 2, 5 7, 10 7, 10 2, 5 2))&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co"># verify that polygon is broken, and display reason why it&#39;s broken</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="fu">st_is_valid</span>(x, <span class="at">reason =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Self-intersection[10 7]&quot;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># repair the polygon</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">st_prepair</span>(x)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># verify that repaired polygon is NOT broken</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">st_is_valid</span>(y)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># visualize the polygons</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">0</span>))</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main =</span> <span class="st">&quot;original&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(x, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">main =</span> <span class="st">&quot;repaired&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(y, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="dangling-edge" class="section level3">
<h3>Dangling edge</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># create broken polygon</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">st_as_sfc</span>(<span class="st">&quot;POLYGON((0 0, 10 0, 15 5, 10 0, 10 10, 0 10, 0 0))&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co"># verify that polygon is broken, and display reason why it&#39;s broken</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="fu">st_is_valid</span>(x, <span class="at">reason =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Self-intersection[15 5]&quot;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># repair the polygon</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">st_prepair</span>(x)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co"># verify that repaired polygon is NOT broken</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">st_is_valid</span>(y)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># visualize the polygons</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">0</span>))</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main =</span> <span class="st">&quot;original&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(x, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">main =</span> <span class="st">&quot;repaired&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(y, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADAFBMVEWZmZkAAACPj48REREaGhrMzMwfHx/////kGhzU1NRHR0dubm4AAAT9//82iNkwMDDs7Ox6enojAwD6xXP+//8RAQAAAAiKNwX//Nr4s18LAQAFAABxIQMDInH/+sQBEF3//uz///ueSQf///5InOuy+P/p/v8dAwAAAhYBAQ7E+v8HRpr///j///CiTQi6+f8BC1iu+P8CF2U+keAkEwYFNojX/P/l/f8ABkMHBgn//NY1BwEdDgUHDRhkGQIaU505YY76wm+WQwkWAgAJEiQUDA0sGgv0r1v//uL1//8CETrQfi0iMk0GLnvomkb/+L5NFwJoSC8fM0WTXz8TIDTPjUNXhbaW5P7//uqQYC0dLTcFHFGt9/////Tj9f5pHgPD8f//9regxN1nuvY6i9c4ODgdaLvpoU4ABTTh/f/704RLmdvowY+WaDTi+v9dPCVXquwCBASx6/6T4v34///ds4EDGy0kBQHY+P9RJw10nrSwooHstWelVRVek87Hk2UlcsQ+JhMNS54AByTM+/+GNAVcNRud6v4qCAGALwRMoOl9ZFaPvuD82Iml2/pLDgHTyLYIK2KnazKE1fwBCk1YrPJRpvH36dQIQJP94apoY2D1xXP8//zCsG0PGhrhuo7HdCT/87flrV8fFUbD68yz9/9FbJFMUXejqqVoTRZvmbDJxZPD+v//99fzqFPFw7PCcSPDcCEDGELsy50EIVYBD1tslL5gSzhARklarvH2269Yb45zUTXm59n5uGMROX/83Zlhd6MCG2ZBFwO7i01gkq7k38vYtpjJpI84ODIaPG3EoXaOnMCMjIzAzM1MS07M5fKuz/CTvcTArI3FejBFmej96Mb+66aYmJqmmpiss6xIbame0Ow3TG6ncEjB5fri4ZvR8P4oX6YkOFCi08pym8oVJiSqmHE/ZGU0htbD5vt1q8b5/e3hkT6KOAWZnr6YmJjR0NDQ0dOejn/WhTPgkT76yniHeGm0YBKJ2fxaxdec50cB/Zn9mQCZAI8AjxHmUzXbAAAHPklEQVR42u3dZ3gURRyA8YwCc+idBUPEOxBDkCSSAEpICAQCkoQOoQVEAoi0SBMUEBABQXpHqliwIKIgKgqKhSKioICgYu+99/LN2UuImzwhexd3ub3b9/8ll93J7sxvZ2dmZy+7UZIoN6IgAAgggAACCCCAACIAAggggAACCCCAAooLqrnP8ZS7IMB1lsUldUTtS0+9unV8IHkCyDKgt955+/XocheEGijpwM8/FZwuoKS7u6Wk99z1rfp4UfWYuuMnDb3DX+ak8WOyD34+T9SvV4igVo6YNiO9Z16aSvlMj5z0Fp99Uc9UoBoXilr397ivt4x74tmUFp2eGi3lxTVFk4fHZHff84la3+fQ7Oz0nq0WF9WgMpKrjC3IyWp1p5lASb3aCC2uXuwH+nquKASKHRavlk7I0QG5+3rVosTBHrk21/832kdzgbY/JJreEHfzXG3r7sybNKAJKdovnQfK/De03Qvf3nHFQKWTy93+jN3lNRHouuaiw+ZHr/KK+gUKSIzN2nmLH+hEruiw/6t9QgckEjZuGlVddJ4V29GXkHf4eK76aDLQ2MTuD47bMEAsG/TScm/MYI8CEo9vnjJJxDT2nFgilh1bOsqXuKoYqHTydnVEYqtNqjDmAcXe40u4Plq2u1IM/0cDUkfKX+b1XXwqT/LmeH0NGtpeNpunspY0bd2eVNnsNnFFQ5OBEkbcKGXb6okrpew6QDRJVUAJ1/qP4pqCtQvWLYyWbdu4G3tOApVOvqi5uDVNK4x5QGpjtR+QMm6YL2alAnJ/4ykC+ltVXrXblvo26M1omdxANLpcyuSlv62b4TMf6Ml+6ph19MX0HTLklQzRqJ8C2ttQFh0Lufr4XzsyhA6odPKt3pj5qjBdfOYBqV3XmqV+Pt9GFV9rpKMLgTSIfv7VOqC6J4HWzlZnelaK+UC1HlElfswnCqPpHAXUOVX699ovuZdqFROreHVApZP/4NPqmyqMBTXIG7NK6oCSpoqmvf29SBlAfRqImfuPfl/HAqDL/FVi+IqiRUU1qMaP6sefE8XBQf3V/nRAJZOrqqNKIeVWryVt0Ao90PrffYnzo2XramUBqRNvTYHsWtMaINWoJDytuvKXX3s1TQHNVHVCa1vq/aFVj7gu3lJA+uSt47U2qM9UYXIvNlnrxdYU6IE8i7TlU3JFWUAq2x2+W6r+xhqgDS3F9oXPvRjvnt7e34tNVr2YOoqqZck8fGifKA2kS35NS9WLvat6WhOB8kuOg4qBkv2jjhYZZQHlb9NO+5k52lloAVDcvRP9WXphYPE4yJ1ZIHcv0T58qXWmJYB0yWN7eU0fBxWNpDd+JEsCyT5q2Nzp2LwyG+ktH+ZkffD+Np97uscCIBk7sluGGhr3LxpJz87unqcGgXEjx2T3zft4ibh9TgkgXXKZP36H2SPpU8XqX35Ve1R1NrN9CKckNKBUW84HqW7NnXl09XJv4nwPQGXFlqn+4UXMp6MlQGVG8oEFR47sGhTKE0wNVHvsfC+NKVfmpAECCCCACIAAAggggAACCCACIIAAAggggAACCCACIIAAAggggAACiAAIIIAAAggggAAiAAIIIIAAAggggAAiAAIIIIAAAggggAiAAAIIIJcKW2TCZUsg18mwRyaibOsTSiFdJgAKYyCXHfIAUDgDVQ5RhA2Qq0pIwhU2QFEhCoAAcgZQVJQNhGwMFBVlByEbXqzawKdYyKbTHVVDrFNkVNW280FVK9kBqBJAAAEEEEAARQKQZXNTFdywvYAsm76r+IZtBWTZBOf/2LBNgVwW+QS/YbsCuawCcgFUvg9ATgFynWlaRCbQGeZFZAJZNO8NkKFQhABZdutEAlSuUIRci1l26yQyruYtu3cSEdMdlmXo7LMkQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEECRAKT/LhFAp/5aNUBGXzsHKIB/fAEIIIAAAggggABioAiQP84/l0uN8n3O42LVyIfpjiB8ADLwAcjAByADH4AMfAAy8AHIwAcgAx+ADHwAMvAByMAHIAMfgAx8ADLwcTyQkY/TgQx9HA5k7ONsoAB8HA0UiI+TgQLycTBQYD7OBQrQx7FAgfo4FShgH4cCBe7jTKAgfBwJFIyPE4GC8nEgUHA+zntUaZA+jnvYbbA+jntccrA+PHA7XIF4ZPtpBOK1EY58bQQvHjEAkuYFQACZKRQhQNIqoAgZB0lpkVCYP1iAl0AGdDUvLYlIefGI3QIggAACCCCAAIpcIJcdgFx2BbLqLktFZkRtCGTVTZaKzhjbGMhlBx9bA7ls4AMQQJEM5KoSknCFDVDlEEXYANniNAcofIHsMRgDKMyApA189Jmw49V8qHX+I7LrdIedAiCAAAIIIIAAAgggAiCAAAIIIIAAAogACCCAAAIIIIAAIgACCCCAAAIIIIAAIgACCCCAAAIIIIAIgAAC6LTFvwhoc5zqnKyiAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
</div>
<div id="two-adjacent-inner-rings" class="section level3">
<h3>Two adjacent inner rings</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># create broken polygon</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">st_as_sfc</span>(</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="fu">paste</span>(</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>    <span class="st">&quot;POLYGON((0 0, 10 0, 10 10, 0 10, 0 0),&quot;</span>,</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>    <span class="st">&quot;(1 1, 1 8, 3 8, 3 1, 1 1), (3 1, 3 8, 5 8, 5 1, 3 1))&quot;</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  )</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co"># verify that polygon is broken, and display reason why it&#39;s broken</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="fu">st_is_valid</span>(x, <span class="at">reason =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Self-intersection[3 8]&quot;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># repair the polygon</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">st_prepair</span>(x)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co"># verify that repaired polygon is NOT broken</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="fu">st_is_valid</span>(y)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># visualize the polygons</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">0</span>))</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main =</span> <span class="st">&quot;original&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(x, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">main =</span> <span class="st">&quot;repaired&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(y, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="polygon-with-an-inner-ring-inside-another-inner-ring" class="section level3">
<h3>Polygon with an inner ring inside another inner ring</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># create broken polygon</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">st_as_sfc</span>(</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="fu">paste</span>(</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>    <span class="st">&quot;POLYGON((0 0, 10 0, 10 10, 0 10, 0 0),&quot;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>    <span class="st">&quot;(2 8, 5 8, 5 2, 2 2, 2 8), (3 3, 4 3, 3 4, 3 3))&quot;</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  )</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>)</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="co"># verify that polygon is broken, and display reason why it&#39;s broken</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="fu">st_is_valid</span>(x, <span class="at">reason =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Holes are nested[3 3]&quot;</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># repair the polygon</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">st_prepair</span>(x)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="co"># verify that repaired polygon is NOT broken</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="fu">st_is_valid</span>(y)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># visualize the polygons</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">0</span>))</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main =</span> <span class="st">&quot;original&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(x, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">main =</span> <span class="st">&quot;repaired&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(y, <span class="st">&quot;POINT&quot;</span>)), <span class="at">col =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="citation" class="section level2">
<h2>Citation</h2>
<p>We recommend citing the methodology that underpins the <em>prepr
R</em> package. To cite this work, please use:</p>
<blockquote>
<p>Ledoux H, Arroyo Ohori K, and Meijers M (2014) A triangulation-based
approach to automatically repair GIS polygons. <em>Computers &amp;
Geosciences</em> 66:121–131.</p>
</blockquote>
</div>
<div id="getting-help" class="section level2">
<h2>Getting help</h2>
<p>If you have any questions about using the <em>prepr R</em> package or
suggestions for improving it, please <a href="https://github.com/prioritizr/prepr/issues/new">file an issue at
the package’s online code repository</a>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
